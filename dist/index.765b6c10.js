function e(e){return e&&e.__esModule?e.default:e}function t(e,t,s,i){let n;s=s||0;let a=(i=i||t.length-1)<=2147483647;for(;i-s>1;)n=a?s+i>>1:r((s+i)/2),t[n]<e?s=n:i=n;return e-t[s]<=t[i]-e?s:i}function s(e,t,s,i){const a=t-e,o=u(a||n(t)||1),l=r(o),c=h(10,l)*s,d=0==a?c:0;let p=y(function(e,t){return r(e/t)*t}(e-d,c)),g=y(v(t+d,c));return i&&(0==a?t>0?(p=0,g=2*t):t<0&&(g=0,p=2*e):(g-t<c&&(g+=c),e-p<c&&(p-=c),e>=0&&p<0&&(p=0),t<=0&&g>0&&(g=0))),[p,g]}const i=Math,n=i.abs,r=i.floor,a=i.round,o=i.ceil,l=i.min,c=i.max,h=i.pow,u=i.log10,d=i.PI,p=1/0;function g(e,t){return a(e/t)*t}function f(e,t,s){return l(c(e,t),s)}function m(e){return"function"==typeof e?e:()=>e}function v(e,t){return o(e/t)*t}function _(e){return a(1e3*e)/1e3}function y(e){return a(1e6*e)/1e6}const b=Array.isArray;function S(e){return"object"==typeof e&&null!==e}function w(e){let t;if(b(e))t=e.map(w);else if(S(e))for(var s in t={},e)t[s]=w(e[s]);else t=e;return t}function x(e){let t=arguments;for(let s=1;s<t.length;s++){let i=t[s];for(let t in i)S(e[t])?x(e[t],w(i[t])):e[t]=w(i[t])}return e}const k=requestAnimationFrame,I=document,D=window,E=devicePixelRatio;function M(e,t){null!=t&&e.classList.add(t)}function C(e,t,s){e.style[t]=s+"px"}function R(e,t,s,i){let n=I.createElement(e);return null!=t&&M(n,t),null!=s&&s.insertBefore(n,i),n}function T(e,t){return R("div",e,t)}function P(e,t,s){e.style.transform="translate("+t+"px,"+s+"px)"}const B={passive:!0};function $(e,t,s){t.addEventListener(e,s,B)}function F(e,t,s){t.removeEventListener(e,s,B)}const O=["January","February","March","April","May","June","July","August","September","October","November","December"],L=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function V(e){return e.slice(0,3)}const A=L.map(V),z=O.map(V),N={MMMM:O,MMM:z,WWWW:L,WWW:A};function G(e){return(e<10?"0":"")+e}const H={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,t)=>t.MMMM[e.getMonth()],MMM:(e,t)=>t.MMM[e.getMonth()],MM:e=>G(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>G(e.getDate()),D:e=>e.getDate(),WWWW:(e,t)=>t.WWWW[e.getDay()],WWW:(e,t)=>t.WWW[e.getDay()],HH:e=>G(e.getHours()),H:e=>e.getHours(),h:e=>{let t=e.getHours();return 0==t?12:t>12?t-12:t},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>G(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>G(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>{return((t=e.getMilliseconds())<10?"00":t<100?"0":"")+t;var t}};function Y(e,t){t=t||N;let s,i=[],n=/\{([a-z]+)\}|[^{]+/gi;for(;s=n.exec(e);)i.push("{"==s[0][0]?H[s[1]]:s[0]);return e=>{let s="";for(let n=0;n<i.length;n++)s+="string"==typeof i[n]?i[n]:i[n](e,t);return s}}function W(e,t,s){let i=[];for(let r=e;r<t;r++)for(let e=0;e<s.length;e++){let t=s[e]*h(10,r);i.push(+t.toFixed(n(r)))}return i}const q=[1,2,5],j=W(-12,0,q),U=W(0,12,q),J=j.concat(U);const Z=[5e-4].concat(W(-3,0,q),[1,5,10,15,30,60,300,600,900,1800,3600,7200,10800,14400,21600,28800,43200,86400,172800,259200,345600,432e3,518400,604800,691200,777600,864e3,1296e3,2592e3,5184e3,7776e3,10368e3,15552e3,31536e3,63072e3,15768e4,31536e4,7884e5,15768e5,31536e5]);function X(e,t){return e.map((e=>[e[0],t(e[1]),e[2],t(e[4]?e[1]+e[3]:e[3])]))}const K=[[31536e3,"{YYYY}",7,"",1],[2419200,"{MMM}",7,"\n{YYYY}",1],[86400,"{M}/{D}",7,"\n{YYYY}",1],[3600,"{h}{aa}",4,"\n{M}/{D}",1],[60,"{h}:{mm}{aa}",4,"\n{M}/{D}",1],[1,":{ss}",2,"\n{M}/{D} {h}:{mm}{aa}",1],[.001,":{ss}.{fff}",2,"\n{M}/{D} {h}:{mm}{aa}",1]];function Q(e,t){return(s,i,n,r)=>{let a=t.find((e=>r>=e[0]))||t[t.length-1],o=null,l=null,c=null;return i.map(((t,s)=>{let i=e(t),n=i.getFullYear(),r=i.getDate(),h=i.getMinutes(),u=n!=o,d=r!=l,p=h!=c,g=7==a[2]&&u||4==a[2]&&d||2==a[2]&&p?a[3]:a[1];return o=n,l=r,c=h,g(i)}))}}function ee(e,t,s){return new Date(e,t,s)}function te(e,t){return t(e)}function se(e,t){return(s,i)=>t(e(i))}const ie={show:!0,x:!0,y:!0,lock:!1,points:{show:function(e,t){let s=e.series[t],i=T();i.style.background=s.stroke||"#000";let n=fe(s.width,1),r=(n-1)/-2;return C(i,"width",n),C(i,"height",n),C(i,"marginLeft",r),C(i,"marginTop",r),i}},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,_x:!1,_y:!1},focus:{prox:-1},locked:!1,left:-10,top:-10,idx:null},ne={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},re=x({},ne,{size:10}),ae='12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',oe="bold "+ae,le={type:"x",show:!0,scale:"x",space:50,gap:5,size:50,labelSize:30,labelFont:oe,side:2,grid:ne,ticks:re,font:ae,rotate:0},ce={show:!0,scale:"x",min:p,max:-p,idxs:[]};let he=new Intl.NumberFormat(navigator.language);function ue(e,t,s,i){return t.map(he.format)}function de(e,t,s,i,n,r){let a=[];for(let e=t=r?t:+v(t,i).toFixed(12);e<=s;e=+(e+i).toFixed(12))a.push(e);return a}function pe(e,t){return t}const ge={type:"y",show:!0,scale:"y",space:40,gap:5,size:50,labelSize:30,labelFont:oe,side:3,grid:ne,ticks:re,font:ae,rotate:0};function fe(e,t){return _((3+2*(e||1))*t)}const me={scale:"y",show:!0,band:!1,spanGaps:!1,alpha:1,points:{show:function(e,t){const s=fe(e.series[t].width,E);let i=e.bbox.width/s/2,n=e.series[0].idxs;return n[1]-n[0]<=i}},values:null,min:p,max:-p,idxs:[],path:null,clip:null},ve={time:!0,auto:!1,distr:1,min:null,max:null},_e=x({},ve,{time:!1,auto:!0}),ye={};function be(e){let t=[];return{sub:function(e){t.push(e)},unsub:function(e){t=t.filter((t=>t!=e))},pub:function(e,s,i,n,r,a,o){t.length>1&&t.forEach((t=>{t!=s&&t.pub(e,s,i,n,r,a,o)}))}}}function Se(e,t,s,i){return(i?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map(((e,i)=>we(e,i,t,s)))}function we(e,t,s,i){return x({},0==t||e&&e.side%2==0?s:i,e)}function xe(e,t,s,i){return i+(1-(e-t.min)/(t.max-t.min))*s}function ke(e,t,s,i){return i+(e-t.min)/(t.max-t.min)*s}function Ie(e,t,s){return[t,s>t?s:s+86400]}function De(e,t,s){const i=s-t;if(0==i){const e=u(i||n(s)||1),a=r(e)+1;return[t,v(s,h(10,a))]}return[t,s]}function Ee(e,t,i){return s(t,i,.2,!0)}function Me(e){return 0==e.button}function Ce(e){let t;return[e=e.replace(/\d+/,(e=>t=a(e*E))),t]}function Re(e,s,i){const o={},h=o.root=T("uplot");if(null!=e.id&&(h.id=e.id),M(h,e.class),e.title){T("title",h).textContent=e.title}const u=R("canvas"),S=o.ctx=u.getContext("2d"),B=T("wrap",h),O=T("under",B);B.appendChild(u);const L=T("over",B);((e=w(e)).plugins||[]).forEach((t=>{t.opts&&(e=t.opts(o,e)||e)}));let V=!1;const A=o.series=Se(e.series||[],ce,me,!1),z=o.axes=Se(e.axes||[],le,ge,!0),N=o.scales=x({},{x:ve,y:_e},e.scales),G=x({x:a(ge.size/2),y:a(le.size/3)},e.gutters),H=e.tzDate||(e=>new Date(1e3*e)),W=e.fmtDate||Y,q=(j=H,(e,t,s,i,n)=>{let a=[],o=i>=2592e3&&i<31536e3,l=j(t),c=l/1e3,h=ee(l.getFullYear(),l.getMonth(),o?1:l.getDate()),u=h/1e3;if(o){let e=i/2592e3,t=c==u?c:ee(h.getFullYear(),h.getMonth()+e,1)/1e3,n=new Date(1e3*t),r=n.getFullYear(),o=n.getMonth();for(let i=0;t<=s;i++){let n=ee(r,o+e*i,1),l=n-j(n/1e3);t=(+n+l)/1e3,t<=s&&a.push(t)}}else{let e=i>=86400?86400:i,o=u+(r(t)-r(c))+v(c-u,e);a.push(o);let l=j(o),h=l.getHours()+l.getMinutes()/60+l.getSeconds()/3600,d=i/3600;for(;;){o=_(o+i);let e=r(y(h+d))%24,t=j(o).getHours()-e;if(t>1&&(t=-1),o-=3600*t,o>s)break;h=(h+d)%24,_((o-a[a.length-1])/i)*n>=.7&&a.push(o)}}return a});var j;const ne=Q(H,X(K,W)),re=se(H,te("{YYYY}-{MM}-{DD} {h}:{mm}{aa}",W)),ae={};for(let e in N){let t=N[e];null==t.min&&null==t.max||(ae[e]={min:t.min,max:t.max})}const oe=x({show:!0},e.legend).show;let he,Re,Te=[],Pe=!1;if(oe){he=R("table","legend",h);const e=A[1]?A[1].values:null;if(Pe=null!=e,Pe){let t=R("tr","labels",he);for(var Be in R("th",null,t),Re=e(o,1,0),Re)R("th",null,t).textContent=Be}else Re={_:0},M(he,"inline")}const $e=o.cursor=x({},ie,e.cursor);$e.points.show=m($e.points.show);const Fe=o.focus=x({},e.focus||{alpha:.3},$e.focus),Oe=Fe.prox>=0;let Le=[null];function Ve(e,t){const s=e.scale,i=N[s]=x({},0==t?ve:_e,N[s]);let n=i.time;i.range=m(i.range||(n?Ie:0==t?De:Ee));let r=e.value;if(e.value=n?"string"==typeof r?se(H,te(r,W)):r||re:r||pe,e.label=e.label||(n?"Time":"Value"),t>0){e.width=null==e.width?1:e.width,e.paths=e.paths||vt;let t=fe(e.width,1);e.points=x({},{size:t,width:c(1,.2*t)},e.points),e.points.show=m(e.points.show),e._paths=null}if(oe&&Te.splice(t,0,function(e,t){if(0==t&&Pe)return null;let s=[],i=R("tr","series",he,he.childNodes[t]);M(i,e.class),e.show||M(i,"off");let n=R("th",null,i),r=T("ident",n);e.width&&(r.style.borderColor=e.stroke),r.style.backgroundColor=e.fill;let a=T("text",n);for(var o in a.textContent=e.label,t>0&&($("click",n,(t=>{$e.locked||Me(t)&&Pt(A.indexOf(e),{show:!e.show},ns.setSeries)})),Oe&&$("mouseenter",n,(t=>{$e.locked||Pt(A.indexOf(e),{focus:!0},ns.setSeries)}))),Re){let e=R("td",null,i);e.textContent="--",s.push(e)}return s}(e,t)),$e.show){let s=function(e,t){if(t>0){let s=$e.points.show(o,t);if(s)return M(s,"cursor-pt"),M(s,e.class),P(s,-10,-10),L.insertBefore(s,Le[t]),s}}(e,t);s&&Le.splice(t,0,s)}}o.addSeries=function(e,t){e=we(e,t=null==t?A.length:t,ce,me),A.splice(t,0,e),Ve(A[t],t)},o.delSeries=function(e){A.splice(e,1),oe&&Te.splice(e,1)[0][0].parentNode.remove(),Le.length>1&&Le.splice(e,1)[0].remove()},A.forEach(Ve);for(let e in N){let t=N[e];null!=t.from&&(N[e]=x({},N[t.from],t))}const Ae=A[0].scale,ze=N[Ae].distr;let Ne;z.forEach((function(e,t){if(e.show){let t=e.side%2,s=N[e.scale];null==s&&(e.scale=t?A[1].scale:Ae,s=N[e.scale]);let i=s.time;e.space=m(e.space),e.rotate=m(e.rotate),e.incrs=m(e.incrs||(2==s.distr?U:i?Z:J)),e.split=m(e.split||(i&&1==s.distr?q:de));let n=e.values;e.values=i?b(n)?Q(H,X(n,W)):n||ne:n||ue,e.font=Ce(e.font),e.labelFont=Ce(e.labelFont)}}));let Ge=null,He=null;const Ye=A[0].idxs;let We,qe,je,Ue,Je,Ze,Xe,Ke,Qe,et,tt=null;function st(e,t){(e=e||[])[0]=e[0]||[],o.data=e,s=e.slice(),tt=s[0],Ne=tt.length,2==ze&&(s[0]=tt.map(((e,t)=>t))),bt(),is("setData"),!1!==t&&it()}function it(){Ge=Ye[0]=0,He=Ye[1]=Ne-1;let e=2==ze?Ge:s[0][Ge],t=2==ze?He:s[0][He];Tt(Ae,e,t)}function nt(e,t,s,i){S.strokeStyle=e||"#000",S.lineWidth=t,S.lineJoin="round",S.setLineDash(s||[]),S.fillStyle=i||"#000"}function rt(e,t){o.width=We=je=e,o.height=qe=Ue=t,Je=Ze=0,function(){let e=!1,t=!1,s=!1,i=!1;z.forEach(((n,r)=>{if(n.show){let{side:r,size:a}=n,o=r%2,l=a+(n.labelSize=null!=n.label?n.labelSize||30:0);l>0&&(o?(je-=l,3==r?(Je+=l,i=!0):s=!0):(Ue-=l,0==r?(Ze+=l,e=!0):t=!0))}})),(e||t)&&(s||(je-=G.x),i||(je-=G.x,Je+=G.x));(i||s)&&(t||(Ue-=G.y),e||(Ue-=G.y,Ze+=G.y))}(),function(){let e=Je+je,t=Ze+Ue,s=Je,i=Ze;function n(n,r){switch(n){case 1:return e+=r,e-r;case 2:return t+=r,t-r;case 3:return s-=r,s+r;case 0:return i-=r,i+r}}z.forEach(((e,t)=>{let s=e.side;e._pos=n(s,e.size),null!=e.label&&(e._lpos=n(s,e.labelSize))}))}();let s=o.bbox;Xe=s.left=g(Je*E,.5),Ke=s.top=g(Ze*E,.5),Qe=s.width=g(je*E,.5),et=s.height=g(Ue*E,.5),C(O,"left",Je),C(O,"top",Ze),C(O,"width",je),C(O,"height",Ue),C(L,"left",Je),C(L,"top",Ze),C(L,"width",je),C(L,"height",Ue),C(B,"width",We),C(B,"height",qe),u.width=a(We*E),u.height=a(qe*E),qt(),V&&Tt(Ae,N[Ae].min,N[Ae].max),V&&is("setSize")}function at(){if(Vt)zt=!0;else{if(Ne>0){let e=w(N);for(let t in e){let s=e[t],i=ae[t];null!=i?(x(s,i),t==Ae&&bt()):t!=Ae&&(s.min=p,s.max=-p)}A.forEach(((i,n)=>{let r=i.scale,a=e[r];if(0==n){let e=a.range(o,a.min,a.max);a.min=e[0],a.max=e[1],Ge=t(a.min,s[0]),He=t(a.max,s[0]),s[0][Ge]<a.min&&Ge++,s[0][He]>a.max&&He--,i.min=tt[Ge],i.max=tt[He]}else if(i.show&&null==ae[r]){let e=i.min==p?a.auto?function(e,t,s){let i=p,n=-p;for(let r=t;r<=s;r++)null!=e[r]&&(i=l(i,e[r]),n=c(n,e[r]));return[i,n]}(s[n],Ge,He):[0,100]:[i.min,i.max];a.min=l(a.min,i.min=e[0]),a.max=c(a.max,i.max=e[1])}i.idxs[0]=Ge,i.idxs[1]=He}));for(let t in e){let s=e[t];if(null==s.from&&s.min!=p&&null==ae[t]){let e=s.range(o,s.min,s.max);s.min=e[0],s.max=e[1]}}for(let t in e){let s=e[t];if(null!=s.from){let t=e[s.from];if(t.min!=p){let e=s.range(o,t.min,t.max);s.min=e[0],s.max=e[1]}}}let i={};for(let t in e){let s=e[t],n=N[t];n.min==s.min&&n.max==s.max||(n.min=s.min,n.max=s.max,i[t]=!0)}A.forEach((e=>{i[e.scale]&&(e._paths=null)}));for(let e in i)is("setScale",e)}for(let e in ae)ae[e]=null;$e.show&&Yt()}}o.setData=st,o.bbox={},o.setSize=function({width:e,height:t}){rt(e,t)};let ot,lt,ct,ht,ut,dt,pt,gt=1;function ft(){A.forEach(((e,t)=>{if(t>0&&e.show&&Ne>0&&null==e._paths){let i=function(e){let t=f(Ge-1,0,Ne-1),s=f(He+1,0,Ne-1);for(;null==e[t]&&t>0;)t--;for(;null==e[s]&&s<Ne-1;)s++;return[t,s]}(s[t]);e._paths=e.paths(o,t,i[0],i[1])}})),A.forEach(((e,t)=>{t>0&&e.show&&(e._paths&&function(e){const t=A[e];if(1==gt){const{stroke:e,fill:s,clip:i}=t._paths,n=_(t.width*E),r=n%2/2;nt(t.stroke,n,t.dash,t.fill),S.globalAlpha=t.alpha,S.translate(r,r),S.save();let a=Xe,o=Ke,l=Qe,c=et,h=n*E/2;0==t.min&&(c+=h),0==t.max&&(o-=h,c+=h),S.beginPath(),S.rect(a,o,l,c),S.clip(),null!=i&&S.clip(i),t.band?(S.fill(e),n&&S.stroke(e)):(n&&S.stroke(e),null!=t.fill&&S.fill(s)),S.restore(),S.translate(-r,-r),S.globalAlpha=1}t.band&&(gt*=-1)}(t),e.points.show(o,t,Ge,He)&&function(e){let t=A[e],i=t.points;const n=_(i.width*E),r=n%2/2,o=i.width>0;let l=(i.size-i.width)/2*E,c=_(2*l);S.translate(r,r),S.save(),S.beginPath(),S.rect(Xe-c,Ke-c,Qe+2*c,et+2*c),S.clip(),S.globalAlpha=t.alpha;const h=new Path2D;for(let i=Ge;i<=He;i++)if(null!=s[e][i]){let n=a(ke(s[0][i],N[Ae],Qe,Xe)),r=a(xe(s[e][i],N[t.scale],et,Ke));h.moveTo(n+l,r),h.arc(n,r,l,0,2*d)}nt(i.stroke||t.stroke||"#000",n,null,i.fill||(o?"#fff":t.stroke||"#000")),S.fill(h),o&&S.stroke(h),S.globalAlpha=1,S.restore(),S.translate(-r,-r)}(t),is("drawSeries",t))}))}function mt(e,t,s){let i=e[e.length-1];i&&i[0]==t?i[1]=s:e.push([t,s])}function vt(e,t,i,n){const r=A[t],o=s[0],h=s[t],u=N[Ae],d=N[r.scale],g=1==gt?{stroke:new Path2D,fill:null,clip:null}:A[t-1]._paths,f=g.stroke,m=_(r.width*E);let v,y,b=p,S=-p,w=[],x=a(ke(o[1==gt?i:n],u,Qe,Xe));r.band&&1==gt&&i==Ge&&(m&&f.lineTo(-m,a(xe(h[i],d,et,Ke))),u.min<o[0]&&w.push([Xe,x-1]));for(let e=1==gt?i:n;e>=i&&e<=n;e+=gt){let t=a(ke(o[e],u,Qe,Xe));if(t==x)null!=h[e]&&(v=a(xe(h[e],d,et,Ke)),b=l(v,b),S=c(v,S));else{let s=!1;b!=p?(f.lineTo(x,b),f.lineTo(x,S),f.lineTo(x,v),y=x):s=!0,null!=h[e]?(v=a(xe(h[e],d,et,Ke)),f.lineTo(t,v),b=S=v,t-x>1&&null==h[e-1]&&(s=!0)):(b=p,S=-p),s&&mt(w,y,t),x=t}}if(null==h[n]&&mt(w,y,x),r.band){let e,t,s=100*m;-1==gt&&i==Ge&&(t=Xe-s,e=i),1==gt&&n==He&&(t=Xe+Qe+s,e=n,u.max>o[Ne-1]&&w.push([x,Xe+Qe])),f.lineTo(t,a(xe(h[e],d,et,Ke)))}if(1==gt&&(g.clip=function(e,t,s,i){let n=A[e],r=null;if(t.length>0){if(n.spanGaps){let e=t[0],n=t[t.length-1];t=[],s&&t.push(e),i&&t.push(n)}r=new Path2D;let e=Xe;for(let s=0;s<t.length;s++){let i=t[s];r.rect(e,Ke,i[0]-e,Ke+et),e=i[1]}r.rect(e,Ke,Xe+Qe-e,Ke+et)}return r}(t,w,null==h[i],null==h[n]),null!=r.fill)){let e=g.fill=new Path2D(f),t=a(xe(0,d,et,Ke));e.lineTo(Xe+Qe,t),e.lineTo(Xe,t)}return r.band&&(gt*=-1),g}function _t(e,t,s,i){let n;if(i<=0)n=[0,0];else{let r=e.space(o,t,s,i);n=function(e,t,s,i){let n=s/e;for(var r=0;r<t.length;r++){let e=t[r]*n;if(e>=i)return[t[r],e]}}(s-t,e.incrs(o,t,s,i,r),i,r),n.push(n[1]/r)}return n}function yt(e,t,s,i,n,r,a,o){let l=r%2/2;S.translate(l,l),nt(a,r,o),S.beginPath();let c,h,u,d,p=i+(0==s||3==s?-n:n);0==t?(h=i,d=p):(c=i,u=p),e.forEach(((e,s)=>{0==t?c=u=e:h=d=e,S.moveTo(c,h),S.lineTo(u,d)})),S.stroke(),S.translate(-l,-l)}function bt(){A.forEach(((e,t)=>{t>0&&(e.min=p,e.max=-p,e._paths=null)}))}function St(){Vt?At=!0:(S.clearRect(0,0,u.width,u.height),is("drawClear"),z.forEach(((e,t)=>{if(!e.show)return;let s=N[e.scale];if(s.min==p)return;let i=e.side,n=i%2,{min:r,max:l}=s,[c,h,u]=_t(e,r,l,0==n?je:Ue),g=2==s.distr,f=e.split(o,r,l,c,u,g),m=0==n?ke:xe,v=0==n?Qe:et,y=0==n?Xe:Ke,b=f.map((e=>a(m(e,s,v,y)))),w=a(e.gap*E),x=e.ticks,k=x.show?a(x.size*E):0,I=e.values(o,2==s.distr?f.map((e=>tt[e])):f,h,2==s.distr?tt[f[1]]-tt[f[0]]:c),D=2==i?e.rotate(o,I,h)*-d/180:0,M=a(e._pos*E),C=M+(k+w)*(0==n&&0==i||1==n&&3==i?-1:1),R=0==n?C:0,T=1==n?C:0;S.font=e.font[0],S.fillStyle=e.stroke||"#000",S.textAlign=D>0?"left":D<0?"right":0==n?"center":3==i?"right":"left",S.textBaseline=D||1==n?"middle":2==i?"top":"bottom";let P=1.5*e.font[1];if(I.forEach(((e,t)=>{0==n?T=b[t]:R=b[t],(""+e).split(/\n/gm).forEach(((e,t)=>{D?(S.save(),S.translate(T,R+t*P),S.rotate(D),S.fillText(e,0,0),S.restore()):S.fillText(e,T,R+t*P)}))})),e.label){S.save();let t=a(e._lpos*E);1==n?(T=R=0,S.translate(t,a(Ke+et/2)),S.rotate((3==i?-d:d)/2)):(T=a(Xe+Qe/2),R=t),S.font=e.labelFont[0],S.textAlign="center",S.textBaseline=2==i?"top":"bottom",S.fillText(e.label,T,R),S.restore()}x.show&&yt(b,n,i,M,k,_(x.width*E),x.stroke);let B=e.grid;B.show&&yt(b,n,0==n?2:1,0==n?Ke:Xe,0==n?et:Qe,_(B.width*E),B.stroke,B.dash)})),is("drawAxes"),ft(),ot=!0,is("draw"))}function wt(e,i){let n=N[e];if(null==n.from){if(e==Ae&&(2==n.distr&&(i.min=t(i.min,s[0]),i.max=t(i.max,s[0])),n.time&&z[0].show&&i.max>i.min)){if(_t(z[0],i.min,i.max,je)[0]<.001)return}ae[e]=i,ot=!1,at(),!ot&&St(),ot=!1}}o.redraw=e=>{!1!==e?Tt(Ae,N[Ae].min,N[Ae].max):St()},o.setScale=wt;let xt=!1;const kt=$e.drag;let It=kt.x,Dt=kt.y;if($e.show){let e="cursor-";$e.x&&(dt=$e.left,lt=T(e+"x",L)),$e.y&&(pt=$e.top,ct=T(e+"y",L))}const Et=o.select=x({show:!0,left:0,width:0,top:0,height:0},e.select),Mt=Et.show?T("select",L):null;function Ct(e,t){if(Et.show){for(let t in e)C(Mt,t,Et[t]=e[t]);!1!==t&&is("setSelect")}}function Rt(e,t){let s=A[e],i=oe?Te[e][0].parentNode:null;var n;s.show?i&&(n="off",i.classList.remove(n)):(i&&M(i,"off"),Le.length>1&&P(Le[e],0,-10))}function Tt(e,t,s){wt(e,{min:t,max:s})}function Pt(e,t,s){let i=A[e];if(null!=t.focus&&function(e){e!=Ft&&(A.forEach(((t,s)=>{!function(e,t){let s=A[e];if(Bt(e,t),s.band){Bt(A[e+1].band?e+1:e-1,t)}}(s,null==e||0==s||s==e?1:Fe.alpha)})),Ft=e,St())}(e),null!=t.show){if(i.show=t.show,Rt(e,t.show),i.band){let s=A[e+1]&&A[e+1].band?e+1:e-1;A[s].show=i.show,Rt(s,t.show)}Tt(Ae,N[Ae].min,N[Ae].max)}is("setSeries",e,t),s&&as.pub("setSeries",o,e,t)}function Bt(e,t){A[e].alpha=t,Te&&(Te[e][0].parentNode.style.opacity=t)}o.setSelect=Ct,o.setSeries=Pt;const $t=Array(A.length);let Ft=null;function Ot(e,t){let s=je;t!=Ae&&(s=Ue,e=s-e);let i=e/s,n=N[t],r=n.max-n.min;return n.min+i*r}function Lt(e){return t(Ot(e,Ae),s[0],Ge,He)}oe&&Oe&&$("mouseleave",he,(e=>{$e.locked||(Pt(null,{focus:!1},ns.setSeries),Yt())})),o.valToIdx=e=>t(e,s[0]),o.posToIdx=Lt,o.posToVal=Ot,o.valToPos=(e,t,s)=>t==Ae?ke(e,N[t],s?Qe:je,s?Xe:0):xe(e,N[t],s?et:Ue,s?Ke:0);let Vt=!1,At=!1,zt=!1,Nt=!1;function Gt(e){Vt=!0,e(o),Vt=!1,zt&&at(),Nt&&Yt(),At&&!ot&&St(),zt=Nt=At=ot=Vt}o.batch=Gt,o.setCursor=e=>{dt=e.left,pt=e.top,Yt()};let Ht=0;function Yt(e,t){if(Vt)return void(Nt=!0);let i;if(Ht=0,$e.show&&($e.x&&P(lt,a(dt),0),$e.y&&P(ct,0,a(pt))),dt<0||0==Ne||Ge>He){i=null;for(let e=0;e<A.length;e++)if(e>0&&($t[e]=p,Le.length>1&&P(Le[e],-10,-10)),oe){if(0==e&&Pe)continue;for(let t=0;t<Te[e].length;t++)Te[e][t].firstChild.nodeValue="--"}Oe&&Pt(null,{focus:!0},ns.setSeries)}else{i=Lt(dt);let e=N[Ae],t=_(ke(s[0][i],e,je,0));for(let e=0;e<A.length;e++){let r=A[e];if(e>0&&r.show){let a=s[e][i],o=null==a?-10:_(xe(a,N[r.scale],Ue,0));$t[e]=o>0?n(o-pt):p,Le.length>1&&P(Le[e],t,o)}else $t[e]=p;if(oe){if(i==$e.idx||0==e&&Pe)continue;let t=0==e&&2==ze?tt:s[e],n=Pe?r.values(o,e,i):{_:r.value(o,t[i],e,i)},a=0;for(let t in n)Te[e][a++].firstChild.nodeValue=n[t]}}}if(Et.show&&xt){let e=n(dt-ht),s=n(pt-ut);if(null!=t){let[e,s]=ns.scales,i=t.cursor.drag;if(It=i._x,Dt=i._y,e){let i=N[e],r=t.posToVal(t.select.left,e),a=t.posToVal(t.select.left+t.select.width,e);Et.left=ke(r,i,je,0),Et.width=n(Et.left-ke(a,i,je,0)),C(Mt,"left",Et.left),C(Mt,"width",Et.width),s||(C(Mt,"top",Et.top=0),C(Mt,"height",Et.height=Ue))}if(s){let i=N[s],r=t.posToVal(t.select.top,s),a=t.posToVal(t.select.top+t.select.height,s);Et.top=xe(r,i,Ue,0),Et.height=n(Et.top-xe(a,i,Ue,0)),C(Mt,"top",Et.top),C(Mt,"height",Et.height),e||(C(Mt,"left",Et.left=0),C(Mt,"width",Et.width=je))}}else{It=kt.x&&e>=kt.dist,Dt=kt.y&&s>=kt.dist;let t=kt.uni;if(null!=t?It&&Dt&&(It=e>=t,Dt=s>=t,It||Dt||(s>e?Dt=!0:It=!0)):kt.x&&kt.y&&(It||Dt)&&(It=Dt=!0),It){let t=l(ht,dt);C(Mt,"left",Et.left=t),C(Mt,"width",Et.width=e),Dt||(C(Mt,"top",Et.top=0),C(Mt,"height",Et.height=Ue))}if(Dt){let e=l(ut,pt);C(Mt,"top",Et.top=e),C(Mt,"height",Et.height=s),It||(C(Mt,"left",Et.left=0),C(Mt,"width",Et.width=je))}It||Dt||(C(Mt,"height",Et.height=0),C(Mt,"width",Et.width=0))}}if($e.idx=i,$e.left=dt,$e.top=pt,kt._x=It,kt._y=Dt,null!=e&&(as.pub("mousemove",o,dt,pt,je,Ue,i),Oe)){let e=l.apply(null,$t),t=null;e<=Fe.prox&&$t.some(((s,i)=>{if(s==e)return t=i})),Pt(t,{focus:!0},ns.setSeries)}V&&is("setCursor")}let Wt=null;function qt(){Wt=L.getBoundingClientRect()}function jt(e,t,s,i,n,r,a){$e.locked||(Ut(e,t,s,i,n,r,a,!1,null!=e),null!=e?0==Ht&&(Ht=k(Yt)):Yt(null,t))}function Ut(e,t,s,i,n,r,a,o,l){if(null!=e)s=e.clientX-Wt.left,i=e.clientY-Wt.top;else{if(s<0||i<0)return dt=-10,void(pt=-10);let[e,a]=ns.scales;s=null!=e?ke(t.posToVal(s,e),N[e],je,0):je*(s/n),i=null!=a?xe(t.posToVal(i,a),N[a],Ue,0):Ue*(i/r)}l&&((s<=1||s>=je-1)&&(s=g(s,je)),(i<=1||i>=Ue-1)&&(i=g(i,Ue))),o?(ht=s,ut=i):(dt=s,pt=i)}function Jt(){Ct({width:0,height:0},!1)}function Zt(e,t,s,i,n,r,a){(null!=t||Me(e))&&(xt=!0,It=Dt=kt._x=kt._y=!1,Ut(e,t,s,i,n,r,0,!0,!1),null!=e&&($("mouseup",I,Xt),as.pub("mousedown",o,ht,ut,je,Ue,null)))}function Xt(e,t,s,i,n,r,a){if(null!=t||Me(e)){xt=kt._x=kt._y=!1,Ut(e,t,s,i,n,r,0,!1,!0);let a=Et.width>0||Et.height>0;a&&Ct(Et),kt.setScale&&a?(Gt((()=>{if(It&&Tt(Ae,Ot(Et.left,Ae),Ot(Et.left+Et.width,Ae)),Dt)for(let e in N){let t=N[e];e!=Ae&&null==t.from&&Tt(e,Ot(Et.top+Et.height,e),Ot(Et.top,e))}})),Jt()):$e.lock&&($e.locked=!$e.locked,$e.locked||Yt())}null!=e&&(F("mouseup",I,Xt),as.pub("mouseup",o,dt,pt,je,Ue,null))}function Kt(e,t,s,i,n,r,a){if(!$e.locked){let e=xt;if(xt){let e=!0,t=!0,s=10;if(It&&Dt&&(e=dt<=s||dt>=je-s,t=pt<=s||pt>=Ue-s),It&&e){let e=dt,t=je-dt,s=l(e,t);s==e&&(dt=0),s==t&&(dt=je)}if(Dt&&t){let e=pt,t=Ue-pt,s=l(e,t);s==e&&(pt=0),s==t&&(pt=Ue)}Yt(1),xt=!1}dt=-10,pt=-10,Yt(1),e&&(xt=e)}}function Qt(e,t,s,i,n,r,a){it(),Jt(),null!=e&&as.pub("dblclick",o,dt,pt,je,Ue,null)}const es={};let ts;es.mousedown=Zt,es.mousemove=jt,es.mouseup=Xt,es.dblclick=Qt,es.setSeries=(e,t,s,i)=>{Pt(s,i)},$e.show&&($("mousedown",L,Zt),$("mousemove",L,jt),$("mouseenter",L,qt),$("mouseleave",L,(e=>{k(Kt)})),$("dblclick",L,Qt),ts=function(e,t){let s=null;function i(){s=null,e()}return function(){clearTimeout(s),s=setTimeout(i,t)}}(qt,100),$("resize",D,ts),$("scroll",D,ts),o.syncRect=qt);const ss=o.hooks=e.hooks||{};function is(e,t,s){e in ss&&ss[e].forEach((e=>{e.call(null,o,t,s)}))}(e.plugins||[]).forEach((e=>{for(let t in e.hooks)ss[t]=(ss[t]||[]).concat(e.hooks[t])}));const ns=x({key:null,setSeries:!1,scales:[Ae,null]},$e.sync),rs=ns.key,as=null!=rs?ye[rs]=ye[rs]||be():be();function os(){rt(e.width,e.height),is("init",e,s),st(s||e.data,!1),ae[Ae]?wt(Ae,ae[Ae]):it(),Ct(Et,!1),V=!0,is("ready")}return as.sub(o),o.pub=function(e,t,s,i,n,r,a){es[e](null,t,s,i,n,r,a)},o.destroy=function(){as.unsub(o),F("resize",D,ts),F("scroll",D,ts),h.remove(),is("destroy")},i?i instanceof HTMLElement?(i.appendChild(h),os()):i(o,os):os(),o}Re.assign=x,Re.rangeNum=s,Re.fmtDate=Y,Re.tzDate=function(e,t){let s;return"Etc/UTC"==t?s=new Date(+e+6e4*e.getTimezoneOffset()):(s=new Date(e.toLocaleString("en-US",{timeZone:t})),s.setMilliseconds(e.getMilliseconds())),s};class Te{static scale(e,t,s){const{min:i,max:n}=Te.calculateBounds(e);let r=1;for(;;){const e=Math.pow(10,r),a=i-i%e;let o=n+(n%e==0?0:e-n%e);a===o&&(o+=e);if((o-a)/e<=t||"number"==typeof s&&r===s)return{scaledMin:a,scaledMax:o,scale:e};r++}}static scaleMatrix(e,t,s){const i=e.flat().filter((e=>null!==e)).reduce(((e,t)=>Math.max(e,t)),Number.NEGATIVE_INFINITY);return Te.scale([0,Te.isFiniteOrZero(i)],t,s)}static generateTicks(e,t,s){const i=[];for(let n=e;n<=t;n+=s)i.push(n);return i}static calculateBounds(e){if(0===e.length)return{min:0,max:0};{const t=e.filter((e=>null!==e)),s=t.reduce(((e,t)=>Math.min(e,t)),Number.POSITIVE_INFINITY),i=t.reduce(((e,t)=>Math.max(e,t)),Number.NEGATIVE_INFINITY);return{min:Te.isFiniteOrZero(s),max:Te.isFiniteOrZero(i)}}}static isFiniteOrZero(e){return Number.isFinite(e)?e:0}}class Pe{constructor(){var e,t,s;s=()=>{this._div.style.display="none"},(t="hide")in(e=this)?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,this._div=document.getElementById("tooltip")}set(e,t,s,i,n){this._div.innerHTML=n,this._div.style.display="block";const r=this._div.offsetWidth;e+s+1.2*r>window.innerWidth&&(e-=r,s*=-1),this._div.style.top=`${t+i}px`,this._div.style.left=`${e+s}px`}}class Be{constructor(){this._div=document.getElementById("status-text")}set(e){this._div.innerText=e,this._div.style.display="block"}hide(){this._div.style.display="none"}}const $e=[25565,19132];function Fe(e){const t=new Date(0);return t.setUTCSeconds(e),t.toLocaleTimeString()}function Oe(e){const t=new Date(0);return t.setUTCSeconds(e),t.toLocaleDateString()}function Le(e){return"number"!=typeof e?"-":e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function Ve(e){let t;return{hooks:{init:s=>{t=s.root.querySelector(".over"),t.onmouseenter=()=>e(),t.onmouseleave=()=>e()},setCursor:s=>{const{left:i,top:n,idx:r}=s.cursor;if(null===r)e();else{const s=t.getBoundingClientRect();e({left:s.left+i+window.pageXOffset,top:s.top+n+window.pageYOffset},r)}}}}}var Ae=null;var ze=e(function(){return Ae||(Ae=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return(""+e[0]).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}()),Ae}()+"missing_favicon.7828699d.svg");function Ne(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ge{constructor(e){Ne(this,"getServerRegistrations",(()=>Object.values(this._registeredServers))),this._app=e,this._serverIdsByName=[],this._serverDataById=[],this._registeredServers=[]}assignServers(e){for(let t=0;t<e.length;t++){const s=e[t];this._serverIdsByName[s.name]=t,this._serverDataById[t]=s}}createServerRegistration(e){const t=this._serverDataById[e],s=new He(this._app,e,t);return this._registeredServers[e]=s,s}getServerRegistration(e){if("string"==typeof e){const t=this._serverIdsByName[e];return this._registeredServers[t]}if("number"==typeof e)return this._registeredServers[e]}reset(){this._serverIdsByName=[],this._serverDataById=[],this._registeredServers=[],document.getElementById("server-list").innerHTML=""}}class He{constructor(e,t,s){Ne(this,"playerCount",0),Ne(this,"isVisible",!0),Ne(this,"isFavorite",!1),Ne(this,"rankIndex",void 0),Ne(this,"lastRecordData",void 0),Ne(this,"lastPeakData",void 0),this._app=e,this.serverId=t,this.data=s,this._graphData=[[],[]],this._failedSequentialPings=0}getGraphDataIndex(){return this.serverId+1}addGraphPoints(e,t){this._graphData=[t.slice(),e]}buildPlotInstance(){this._plotInstance=new Re({plugins:[Ve(((e,t)=>{if(e){const s=this._graphData[1][t];"number"!=typeof s?this._app.tooltip.hide():this._app.tooltip.set(e.left,e.top,10,10,`${Le(s)} Players<br>${Fe(this._graphData[0][t])}`)}else this._app.tooltip.hide()}))],height:100,width:400,cursor:{y:!1,drag:{setScale:!1,x:!1,y:!1},sync:{key:"minetrack-server",setSeries:!0}},series:[{},{stroke:"#E9E581",width:2,value:(e,t)=>`${Le(t)} Players`,spanGaps:!0,points:{show:!1}}],axes:[{show:!1},{ticks:{show:!1},font:'14px "Open Sans", sans-serif',stroke:"#A3A3A3",size:55,grid:{stroke:"#333",width:1},split:()=>{const{scaledMin:e,scaledMax:t,scale:s}=Te.scale(this._graphData[1],4);return Te.generateTicks(e,t,s)}}],scales:{y:{auto:!1,range:()=>{const{scaledMin:e,scaledMax:t}=Te.scale(this._graphData[1],4);return[e,t]}}},legend:{show:!1}},this._graphData,document.getElementById(`chart_${this.serverId}`))}handlePing(e,t){"number"==typeof e.playerCount?(this.playerCount=e.playerCount,this._failedSequentialPings=0):++this._failedSequentialPings>5&&(this.playerCount=0),this._graphData[0].push(t),this._graphData[1].push(e.playerCount);for(const e of this._graphData)e.length>this._app.publicConfig.serverGraphMaxLength&&e.shift();this._plotInstance.setData(this._graphData)}updateServerRankIndex(e){this.rankIndex=e,document.getElementById(`ranking_${this.serverId}`).innerText=`#${e+1}`}_renderValue(e,t){const s=document.getElementById(`${e}_${this.serverId}`);s.style.display="block";const i=document.getElementById(`${e}-value_${this.serverId}`)||s;i&&("function"==typeof t?t(i):i.innerText=t)}_hideValue(e){document.getElementById(`${e}_${this.serverId}`).style.display="none"}updateServerStatus(e,t){if(e.versions&&this._renderValue("version",function(e,t){if(!(e&&e.length&&t&&t.length))return;let s=[];const i=[];for(let t=0;t<e.length;t++)t>0&&e[t]-e[t-1]!=1&&(i.push(s),s=[]),s.push(e[t]);return s.length>0&&i.push(s),0!==i.length?i.map((e=>{const s=t[e[0]];return 1===e.length?s:`${s}-${t[e[e.length-1]]}`})).join(", "):void 0}(e.versions,t[this.data.type])||""),e.recordData&&(this._renderValue("record",(t=>{e.recordData.timestamp>0?(t.innerText=`${Le(e.recordData.playerCount)} (${Oe(e.recordData.timestamp)})`,t.title=`At ${Oe(e.recordData.timestamp)} ${Fe(e.recordData.timestamp)}`):t.innerText=Le(e.recordData.playerCount)})),this.lastRecordData=e.recordData),e.graphPeakData&&(this._renderValue("peak",(t=>{t.innerText=Le(e.graphPeakData.playerCount),t.title=`At ${Fe(e.graphPeakData.timestamp)}`})),this.lastPeakData=e.graphPeakData),e.error?(this._hideValue("player-count"),this._renderValue("error",e.error.message)):"number"!=typeof e.playerCount?(this._hideValue("player-count"),this._renderValue("error","Failed to ping")):"number"==typeof e.playerCount&&(this._hideValue("error"),this._renderValue("player-count",Le(e.playerCount))),e.favicon){const t=document.getElementById(`favicon_${this.serverId}`);t.getAttribute("src")!==e.favicon&&t.setAttribute("src",e.favicon)}}initServerStatus(e){const t=document.createElement("div");var s,i;t.id=`container_${this.serverId}`,t.innerHTML=`<div class="column column-favicon">\n        <img class="server-favicon" src="${e.favicon||ze}" id="favicon_${this.serverId}" title="${this.data.name}\n${s=this.data.ip,i=this.data.port,i&&!$e.includes(i)?`${s}:${i}`:s}">\n        <span class="server-rank" id="ranking_${this.serverId}"></span>\n      </div>\n      <div class="column column-status">\n        <h3 class="server-name"><span class="${this._app.favoritesManager.getIconClass(this.isFavorite)}" id="favorite-toggle_${this.serverId}"></span> ${this.data.name}</h3>\n        <span class="server-error" id="error_${this.serverId}"></span>\n        <span class="server-label" id="player-count_${this.serverId}">Players: <span class="server-value" id="player-count-value_${this.serverId}"></span></span>\n        <span class="server-label" id="peak_${this.serverId}">${this._app.publicConfig.graphDurationLabel} Peak: <span class="server-value" id="peak-value_${this.serverId}">-</span></span>\n        <span class="server-label" id="record_${this.serverId}">Record: <span class="server-value" id="record-value_${this.serverId}">-</span></span>\n        <span class="server-label" id="version_${this.serverId}"></span>\n      </div>\n      <div class="column column-graph" id="chart_${this.serverId}"></div>`,t.setAttribute("class","server"),document.getElementById("server-list").appendChild(t)}updateHighlightedValue(e){["player-count","peak","record"].forEach((t=>{const s=document.getElementById(`${t}_${this.serverId}`),i=document.getElementById(`${t}-value_${this.serverId}`);e&&t===e?(s.setAttribute("class","server-highlighted-label"),i.setAttribute("class","server-highlighted-value")):(s.setAttribute("class","server-label"),i.setAttribute("class","server-value"))}))}initEventListeners(){document.getElementById(`favorite-toggle_${this.serverId}`).addEventListener("click",(()=>{this._app.favoritesManager.handleFavoriteButtonClick(this)}),!1)}}class Ye{constructor(e){this._app=e,this._hasRequestedHistoryGraph=!1,this._reconnectDelayBase=0}reset(){this._hasRequestedHistoryGraph=!1}createWebSocket(){let e="ws:";"https:"===location.protocol&&(e="wss:"),this._webSocket=new WebSocket(`${e}//${location.host}`),this._webSocket.onopen=()=>{this._app.caption.set("Loading..."),this._reconnectDelayBase=0},this._webSocket.onclose=e=>{this._app.handleDisconnect(),1006===e.code?this._app.caption.set("Lost connection!"):this._app.caption.set("Disconnected due to error."),this.scheduleReconnect()},this._webSocket.onmessage=e=>{const t=JSON.parse(e.data);switch(t.message){case"init":this._app.setPublicConfig(t.config),this._app.setPageReady(!0),this._app.publicConfig.isGraphVisible&&this.sendHistoryGraphRequest(),t.servers.forEach(((e,s)=>{this._app.addServer(s,e,t.timestampPoints)})),this._app.handleSyncComplete();break;case"updateServers":for(let e=0;e<t.updates.length;e++){const s=this._app.serverRegistry.getServerRegistration(e),i=t.updates[e];s&&(s.handlePing(i,t.timestamp),s.updateServerStatus(i,this._app.publicConfig.minecraftVersions))}t.updateHistoryGraph&&(this._app.graphDisplayManager.addGraphPoint(t.timestamp,Object.values(t.updates).map((e=>e.playerCount))),this._app.graphDisplayManager.redraw()),this._app.percentageBar.redraw(),this._app.updateGlobalStats();break;case"historyGraph":{this._app.graphDisplayManager.buildPlotInstance(t.timestamps,t.graphData);let e=0,s="";this._app.serverRegistry.getServerRegistrations().map((e=>e.data.name)).sort().forEach((t=>{const i=this._app.serverRegistry.getServerRegistration(t);s+=`<td>\n                <input type="checkbox" class="graph-control" minetrack-server-id="${i.serverId}" ${i.isVisible?"checked":""}>\n                ${t}\n                </input></td>`,++e%6==0&&(s+="</tr><tr>")})),document.getElementById("big-graph-checkboxes").innerHTML=`<table><tr>${s}</tr></table>`,document.getElementById("big-graph-controls").style.display="block",this._app.graphDisplayManager.initEventListeners();break}}}}scheduleReconnect(){this._webSocket=void 0,this._reconnectDelayBase++,this._reconnectDelaySeconds=Math.min(this._reconnectDelayBase*this._reconnectDelayBase,30);const e=setInterval((()=>{this._reconnectDelaySeconds--,0===this._reconnectDelaySeconds?(clearInterval(e),this._app.caption.set("Reconnecting..."),this.createWebSocket()):this._reconnectDelaySeconds>0&&this._app.caption.set(`Reconnecting in ${this._reconnectDelaySeconds}s...`)}),1e3)}sendHistoryGraphRequest(){this._hasRequestedHistoryGraph||(this._hasRequestedHistoryGraph=!0,this._webSocket.send("requestHistoryGraph"))}}function We(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const qe=[{getName:()=>"Players",sortFunc:(e,t)=>t.playerCount-e.playerCount,highlightedValue:"player-count"},{getName:e=>`${e.publicConfig.graphDurationLabel} Peak`,sortFunc:(e,t)=>e.lastPeakData||t.lastPeakData?e.lastPeakData&&!t.lastPeakData?-1:t.lastPeakData&&!e.lastPeakData?1:t.lastPeakData.playerCount-e.lastPeakData.playerCount:0,testFunc:e=>{for(const t of e.serverRegistry.getServerRegistrations())if(t.lastPeakData)return!0;return!1},highlightedValue:"peak"},{getName:()=>"Record",sortFunc:(e,t)=>e.lastRecordData||t.lastRecordData?e.lastRecordData&&!t.lastRecordData?-1:t.lastRecordData&&!e.lastRecordData?1:t.lastRecordData.playerCount-e.lastRecordData.playerCount:0,testFunc:e=>{for(const t of e.serverRegistry.getServerRegistrations())if(t.lastRecordData)return!0;return!1},highlightedValue:"record"}];class je{constructor(e){We(this,"handleSortByButtonClick",(()=>{for(;;){this._sortOptionIndex=(this._sortOptionIndex+1)%qe.length;const e=qe[this._sortOptionIndex];if(!e.testFunc||e.testFunc(this._app))break}this.updateSortOption(),this.updateLocalStorage()})),We(this,"updateSortOption",(()=>{const e=qe[this._sortOptionIndex];this._textElement.innerText=e.getName(this._app);for(const t of this._app.serverRegistry.getServerRegistrations())t.updateHighlightedValue(e.highlightedValue);this.sortServers()})),We(this,"sortServers",(()=>{const e=qe[this._sortOptionIndex],t=this._app.serverRegistry.getServerRegistrations().sort(((t,s)=>t.isFavorite&&!s.isFavorite?-1:s.isFavorite&&!t.isFavorite?1:e.sortFunc(t,s))),s=t.map((e=>e.serverId));if(this._lastSortedServers){let e=!0;for(let t=0;t<s.length;t++)if(s[t]!==this._lastSortedServers[t]){e=!1;break}if(e)return}this._lastSortedServers=s;const i=this._app.serverRegistry.getServerRegistrations().sort(e.sortFunc);t.forEach((function(e){const t=document.getElementById("server-list"),s=document.getElementById(`container_${e.serverId}`);t.appendChild(s),e.updateServerRankIndex(i.indexOf(e))}))})),this._app=e,this._buttonElement=document.getElementById("sort-by"),this._textElement=document.getElementById("sort-by-text"),this._sortOptionIndex=0}reset(){this._lastSortedServers=void 0,this._buttonElement.style.display="none",this._textElement.innerText="...",this._buttonElement.removeEventListener("click",this.handleSortByButtonClick)}loadLocalStorage(){if("undefined"!=typeof localStorage){const e=localStorage.getItem("minetrack_sort_option_index");e&&(this._sortOptionIndex=parseInt(e))}}updateLocalStorage(){"undefined"!=typeof localStorage&&(0!==this._sortOptionIndex?localStorage.setItem("minetrack_sort_option_index",this._sortOptionIndex):localStorage.removeItem("minetrack_sort_option_index"))}show(){this.loadLocalStorage(),this.updateSortOption(),this._buttonElement.addEventListener("click",this.handleSortByButtonClick),this._buttonElement.style.display="inline-block"}}class Ue{constructor(e){var t,s,i;i=e=>{e.isFavorite=!e.isFavorite,document.getElementById(`favorite-toggle_${e.serverId}`).setAttribute("class",this.getIconClass(e.isFavorite)),this._app.sortController.sortServers(),this._app.graphDisplayManager.handleServerIsFavoriteUpdate(e),this.updateLocalStorage()},(s="handleFavoriteButtonClick")in(t=this)?Object.defineProperty(t,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[s]=i,this._app=e}loadLocalStorage(){if("undefined"!=typeof localStorage){let e=localStorage.getItem("minetrack_favorite_servers");if(e){e=JSON.parse(e);for(let t=0;t<e.length;t++){const s=this._app.serverRegistry.getServerRegistration(e[t]);s&&(s.isFavorite=!0,document.getElementById(`favorite-toggle_${s.serverId}`).setAttribute("class",this.getIconClass(s.isFavorite)))}}}}updateLocalStorage(){if("undefined"!=typeof localStorage){const e=this._app.serverRegistry.getServerRegistrations().filter((e=>e.isFavorite)).map((e=>e.data.name));e.length>0?localStorage.setItem("minetrack_favorite_servers",JSON.stringify(e)):localStorage.removeItem("minetrack_favorite_servers")}}getIconClass(e){return e?"icon-star server-is-favorite":"icon-star-o server-is-not-favorite"}}function Je(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ze{constructor(e){Je(this,"redraw",(()=>{this.updateLocalStorage();for(const e of this._app.serverRegistry.getServerRegistrations())this._plotInstance.series[e.getGraphDataIndex()].show=e.isVisible;this._plotInstance.redraw()})),Je(this,"resize",(()=>{this._plotInstance.setSize(this.getPlotSize()),this._resizeRequestTimeout&&clearTimeout(this._resizeRequestTimeout),this._resizeRequestTimeout=void 0})),Je(this,"handleServerButtonClick",(e=>{const t=parseInt(e.target.getAttribute("minetrack-server-id")),s=this._app.serverRegistry.getServerRegistration(t);s.isVisible!==e.target.checked&&(s.isVisible=e.target.checked,this._showOnlyFavorites=!1,this.redraw())})),Je(this,"handleShowButtonClick",(e=>{const t=e.target.getAttribute("minetrack-show-type");this._showOnlyFavorites="favorites"===t;let s=!1;this._app.serverRegistry.getServerRegistrations().forEach((function(e){let i;"all"===t?i=!0:"none"===t?i=!1:"favorites"===t&&(i=e.isFavorite),e.isVisible!==i&&(e.isVisible=i,s=!0)})),s&&(this.redraw(),this.updateCheckboxes())})),Je(this,"handleSettingsToggle",(()=>{const e=document.getElementById("big-graph-controls-drawer");"block"!==e.style.display?e.style.display="block":e.style.display="none"})),Je(this,"handleServerIsFavoriteUpdate",(e=>{this._showOnlyFavorites&&e.isVisible!==e.isFavorite&&(e.isVisible=e.isFavorite,this.redraw(),this.updateCheckboxes())})),this._app=e,this._graphData=[],this._graphTimestamps=[],this._hasLoadedSettings=!1,this._initEventListenersOnce=!1,this._showOnlyFavorites=!1}addGraphPoint(e,t){if(!this._hasLoadedSettings)return;const s=this._plotInstance.scales.x,i=s.min>this._graphTimestamps[0]||s.max<this._graphTimestamps[this._graphTimestamps.length-1];this._graphTimestamps.push(e);for(let e=0;e<t.length;e++)this._graphData[e].push(t[e]);const n=this._app.publicConfig.graphMaxLength;this._graphTimestamps.length>n&&this._graphTimestamps.splice(0,this._graphTimestamps.length-n);for(const e of this._graphData)e.length>n&&e.splice(0,e.length-n);this._plotInstance.setData(this.getGraphData(),!i)}loadLocalStorage(){if("undefined"!=typeof localStorage){let e;if(localStorage.getItem("minetrack_show_favorites")&&(this._showOnlyFavorites=!0),e=this._showOnlyFavorites?localStorage.getItem("minetrack_favorite_servers"):localStorage.getItem("minetrack_hidden_servers"),e){e=JSON.parse(e);for(const t of this._app.serverRegistry.getServerRegistrations())this._showOnlyFavorites?t.isVisible=e.indexOf(t.data.name)>=0:t.isVisible=e.indexOf(t.data.name)<0}}}updateLocalStorage(){if("undefined"!=typeof localStorage){const e=this._app.serverRegistry.getServerRegistrations().filter((e=>!e.isVisible)).map((e=>e.data.name));e.length>0&&!this._showOnlyFavorites?localStorage.setItem("minetrack_hidden_servers",JSON.stringify(e)):localStorage.removeItem("minetrack_hidden_servers"),this._showOnlyFavorites?localStorage.setItem("minetrack_show_favorites",!0):localStorage.removeItem("minetrack_show_favorites")}}getVisibleGraphData(){return this._app.serverRegistry.getServerRegistrations().filter((e=>e.isVisible)).map((e=>this._graphData[e.serverId]))}getPlotSize(){return{width:.9*Math.max(window.innerWidth,800),height:400}}getGraphData(){return[this._graphTimestamps,...this._graphData]}getGraphDataPoint(e,t){const s=this._graphData[e];if(s&&t<s.length&&"number"==typeof s[t])return s[t]}getClosestPlotSeriesIndex(e){let t=-1,s=Number.MAX_VALUE;const i=this._plotInstance.bbox.height/devicePixelRatio;for(let n=1;n<this._plotInstance.series.length;n++){const r=this._plotInstance.series[n];if(!r.show)continue;const a=this._plotInstance.data[n][e];if("number"==typeof a){const e=this._plotInstance.scales[r.scale],o=(1-(a-e.min)/(e.max-e.min))*i,l=Math.abs(o-this._plotInstance.cursor.top);l<s&&(t=n,s=l)}}return t}buildPlotInstance(e,t){this._hasLoadedSettings||(this._hasLoadedSettings=!0,this.loadLocalStorage());for(const s of t){const t=e.length-s.length;if(t>0){const e=Array(t).fill(null);s.unshift(...e)}}this._graphTimestamps=e,this._graphData=t;const s=this._app.serverRegistry.getServerRegistrations().map((e=>({stroke:e.data.color,width:2,value:(e,t)=>`${Le(t)} Players`,show:e.isVisible,spanGaps:!0,points:{show:!1}})));this._plotInstance=new Re({plugins:[Ve(((e,t)=>{if(e){const s=this.getClosestPlotSeriesIndex(t),i=this._app.serverRegistry.getServerRegistrations().filter((e=>e.isVisible)).sort(((e,t)=>e.isFavorite!==t.isFavorite?e.isFavorite?-1:1:e.data.name.localeCompare(t.data.name))).map((e=>{const i=this.getGraphDataPoint(e.serverId,t);let n=e.data.name;return s===e.getGraphDataIndex()&&(n=`<strong>${n}</strong>`),e.isFavorite&&(n=`<span class="${this._app.favoritesManager.getIconClass(!0)}"></span> ${n}`),`${n}: ${Le(i)}`})).join("<br>")+`<br><br><strong>${Fe(this._graphTimestamps[t])}</strong>`;this._app.tooltip.set(e.left,e.top,10,10,i)}else this._app.tooltip.hide()}))],...this.getPlotSize(),cursor:{y:!1},series:[{},...s],axes:[{font:'14px "Open Sans", sans-serif',stroke:"#FFF",grid:{show:!1},space:60},{font:'14px "Open Sans", sans-serif',stroke:"#FFF",size:65,grid:{stroke:"#333",width:1},split:()=>{const e=this.getVisibleGraphData(),{scaledMax:t,scale:s}=Te.scaleMatrix(e,10,4);return Te.generateTicks(0,t,s)}}],scales:{y:{auto:!1,range:()=>{const e=this.getVisibleGraphData(),{scaledMin:t,scaledMax:s}=Te.scaleMatrix(e,10,4);return[t,s]}}},legend:{show:!1}},this.getGraphData(),document.getElementById("big-graph")),document.getElementById("settings-toggle").style.display="inline-block"}requestResize(){this._plotInstance&&(this._resizeRequestTimeout&&clearTimeout(this._resizeRequestTimeout),this._resizeRequestTimeout=setTimeout(this.resize,200))}initEventListeners(){this._initEventListenersOnce||(this._initEventListenersOnce=!0,document.getElementById("settings-toggle").addEventListener("click",this.handleSettingsToggle,!1),document.querySelectorAll(".graph-controls-show").forEach((e=>{e.addEventListener("click",this.handleShowButtonClick,!1)}))),document.querySelectorAll(".graph-control").forEach((e=>{e.addEventListener("click",this.handleServerButtonClick,!1)}))}updateCheckboxes(){document.querySelectorAll(".graph-control").forEach((e=>{const t=parseInt(e.getAttribute("minetrack-server-id")),s=this._app.serverRegistry.getServerRegistration(t);e.checked=s.isVisible}))}reset(){this._plotInstance&&(this._plotInstance.destroy(),this._plotInstance=void 0),this._graphTimestamps=[],this._graphData=[],this._hasLoadedSettings=!1,this._resizeRequestTimeout&&(clearTimeout(this._resizeRequestTimeout),this._resizeRequestTimeout=void 0),document.getElementById("big-graph-checkboxes").innerHTML="",document.getElementById("big-graph-controls").style.display="none",document.getElementById("settings-toggle").style.display="none"}}function Xe(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ke{constructor(e){Xe(this,"redraw",(()=>{const e=this._app.serverRegistry.getServerRegistrations().sort((function(e,t){return e.playerCount-t.playerCount})),t=this._app.getTotalPlayerCount();let s=0;for(const i of e){const e=Math.round(i.playerCount/t*this._parent.offsetWidth),n=document.getElementById(`perc-bar-part_${i.serverId}`)||this.createPart(i),r=`${e}px`,a=`${s}px`;n.style.width===r&&n.style.left===a||(n.style.width=r,n.style.left=a),s+=e}})),Xe(this,"handleMouseOver",(e=>{const t=parseInt(e.target.getAttribute("minetrack-server-id")),s=this._app.serverRegistry.getServerRegistration(t);var i,n;this._app.tooltip.set(e.target.offsetLeft,e.target.offsetTop,10,this._parent.offsetTop+this._parent.offsetHeight+10,`${void 0!==s.rankIndex?`#${s.rankIndex+1} `:""}\n      ${s.data.name}<br>\n      ${Le(s.playerCount)} Players<br>\n      <strong>${i=s.playerCount,n=this._app.getTotalPlayerCount(),Math.round(i/n*100*10)/10+"%"}</strong>`)})),Xe(this,"handleMouseOut",(()=>{this._app.tooltip.hide()})),this._app=e,this._parent=document.getElementById("perc-bar")}createPart(e){const t=document.createElement("div");return t.id=`perc-bar-part_${e.serverId}`,t.style.background=e.data.color,t.setAttribute("class","perc-bar-part"),t.setAttribute("minetrack-server-id",e.serverId),this._parent.appendChild(t),t.addEventListener("mouseover",this.handleMouseOver,!1),t.addEventListener("mouseout",this.handleMouseOut,!1),t}reset(){this._parent.innerHTML=""}}function Qe(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const et=new class{constructor(){Qe(this,"publicConfig",void 0),Qe(this,"addServer",((e,t,s)=>{const i=this.serverRegistry.createServerRegistration(e);i.initServerStatus(t),void 0!==t.playerCountHistory&&(i.addGraphPoints(t.playerCountHistory,s),i.playerCount=t.playerCount),i.buildPlotInstance(),i.updateServerStatus(t,this.publicConfig.minecraftVersions),i.initEventListeners()})),Qe(this,"updateGlobalStats",(()=>{const e=this.getTotalPlayerCount();e!==this._lastTotalPlayerCount&&(this._lastTotalPlayerCount=e,document.getElementById("stat_totalPlayers").innerText=Le(e));const t=this.serverRegistry.getServerRegistrations().length;t!==this._lastServerRegistrationCount&&(this._lastServerRegistrationCount=t,document.getElementById("stat_networks").innerText=t)})),this.tooltip=new Pe,this.caption=new Be,this.serverRegistry=new Ge(this),this.socketManager=new Ye(this),this.sortController=new je(this),this.graphDisplayManager=new Ze(this),this.percentageBar=new Ke(this),this.favoritesManager=new Ue(this),this._taskIds=[]}init(){this.socketManager.createWebSocket()}setPageReady(e){document.getElementById("push").style.display=e?"block":"none",document.getElementById("footer").style.display=e?"block":"none",document.getElementById("status-overlay").style.display=e?"none":"block"}setPublicConfig(e){this.publicConfig=e,this.serverRegistry.assignServers(e.servers),this.initTasks()}handleSyncComplete(){this.caption.hide(),this.favoritesManager.loadLocalStorage(),this.sortController.show(),this.percentageBar.redraw(),this.updateGlobalStats()}initTasks(){this._taskIds.push(setInterval(this.sortController.sortServers,5e3))}handleDisconnect(){this.tooltip.hide(),this.serverRegistry.reset(),this.socketManager.reset(),this.sortController.reset(),this.graphDisplayManager.reset(),this.percentageBar.reset(),this.publicConfig=void 0,this._taskIds.forEach(clearInterval),this._taskIds=[],this._lastTotalPlayerCount=void 0,this._lastServerRegistrationCount=void 0,document.getElementById("stat_totalPlayers").innerText=0,document.getElementById("stat_networks").innerText=0,this.setPageReady(!1)}getTotalPlayerCount(){return this.serverRegistry.getServerRegistrations().map((e=>e.playerCount)).reduce(((e,t)=>e+t),0)}};document.addEventListener("DOMContentLoaded",(()=>{et.init(),window.addEventListener("resize",(function(){et.percentageBar.redraw(),et.graphDisplayManager.requestResize()}),!1)}),!1);
//# sourceMappingURL=index.765b6c10.js.map
